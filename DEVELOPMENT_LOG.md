# PDF Optimizer Suite - Отчет о разработке (18-19 января 2026)

## Статус проекта: v3.8.4 (Stable / Final)

### Ключевые достижения (v3.6.2 - v3.8.4):

1.  **Portable Architecture (v3.7.0):**
    *   **Embedded Python:** Полный переход на встроенный интерпретатор Python 3.12 в `resources/python`. Программа больше не зависит от наличия Python в системе или переменной PATH.
    *   **Zero-Install Runtime:** Приложение работает автономно, что критично для корпоративных сред (LTSC) и систем с AppLocker.

2.  **Поддержка Microsoft Word (v3.8.0):**
    *   **Фоновая конвертация:** Добавлен скрипт `docx2pdf.vbs`, использующий COM-автоматизацию для невидимой печати документов `.doc` и `.docx` в PDF.
    *   **Интеграция:** Word-файлы теперь имеют те же опции оптимизации в контекстном меню, что и PDF.

3.  **Регистрация без ограничений (v3.7.2):**
    *   **Native Python Registry:** Отказ от PowerShell и VBS для записи в реестр в пользу нативного скрипта `register.py`. Это позволило обойти политики "Execution Policy" и проблемы с кодировкой кириллицы.

4.  **Исправления и Стабильность (v3.8.1 - v3.8.4):**
    *   **Naming Fix:** Исправлена ошибка именования, при которой конвертированные файлы сохраняли префикс `~temp_`.
    *   **Guaranteed Cleanup:** Внедрена архитектура `try...finally` для 100% удаления временных файлов даже при сбоях.
    *   **Template Fix (v3.8.4):** Исправлена блокировка шаблона `Normal.dot` в Word.

### Технические нюансы (Memory Dump):

*   **Registry Hijacking:** Меню регистрируется одновременно в `SystemFileAssociations` и напрямую в классах `.pdf`, `.doc`, `.docx`. Это необходимо, чтобы наш пункт меню не перекрывался другими программами (Acrobat, Foxit).
*   **Windowless Execution:** Вся цепочка вызовов (`wscript.exe` -> `launcher.vbs` -> `python.exe` -> `subprocess(magick)`) спроектирована так, чтобы ни одно консольное окно не моргнуло на экране. Используется флаг `0x08000000` (CREATE_NO_WINDOW).
*   **JPEG Sampling:** Жестко задан параметр `-sampling-factor 4:2:0`. Это ключевой момент, позволяющий уменьшить размер файла на дополнительные 15-20% без видимой потери качества текста.
*   **Camouflage Profile:** Метаданные выбираются случайно из базы `FAKE_SCANNERS` в `optimizer.pyw`. Это имитирует физический скан, что полезно для обхода автоматических фильтров "цифровых оригиналов".

---
*Проект упакован и залит на GitHub. Актуальная версия v3.8.4.*
